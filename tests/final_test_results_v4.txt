============================= test session starts =============================
platform win32 -- Python 3.12.10, pytest-9.0.2, pluggy-1.6.0 -- D:\Project\PEOPLE_OS\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: D:\Project\PEOPLE_OS
configfile: pytest.ini
plugins: anyio-3.7.1, asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 277 items

backend/tests/test_department_crud.py::TestDepartmentCreation::test_create_department_basic PASSED [  0%]
backend/tests/test_department_crud.py::TestDepartmentCreation::test_create_department_with_description PASSED [  0%]
backend/tests/test_department_crud.py::TestDepartmentCreation::test_create_subdepartment PASSED [  1%]
backend/tests/test_department_crud.py::TestDepartmentCreation::test_create_nested_subdepartments PASSED [  1%]
backend/tests/test_department_crud.py::TestDepartmentCreation::test_create_multiple_departments_same_org PASSED [  1%]
backend/tests/test_department_crud.py::TestDepartmentCreation::test_department_unique_per_organization PASSED [  2%]
backend/tests/test_department_crud.py::TestDepartmentRetrieval::test_retrieve_department_by_id PASSED [  2%]
backend/tests/test_department_crud.py::TestDepartmentRetrieval::test_retrieve_all_departments_in_org PASSED [  2%]
backend/tests/test_department_crud.py::TestDepartmentRetrieval::test_retrieve_department_not_found PASSED [  3%]
backend/tests/test_department_crud.py::TestDepartmentRetrieval::test_retrieve_subdepartments PASSED [  3%]
backend/tests/test_department_crud.py::TestDepartmentRetrieval::test_retrieve_department_with_employees PASSED [  3%]
backend/tests/test_department_crud.py::TestDepartmentUpdate::test_update_department_name PASSED [  4%]
backend/tests/test_department_crud.py::TestDepartmentUpdate::test_update_department_code PASSED [  4%]
backend/tests/test_department_crud.py::TestDepartmentUpdate::test_update_department_description PASSED [  5%]
backend/tests/test_department_crud.py::TestDepartmentDelete::test_delete_empty_department PASSED [  5%]
backend/tests/test_department_crud.py::TestDepartmentDelete::test_delete_department_cascade_check PASSED [  5%]
backend/tests/test_department_crud.py::TestDepartmentErrorHandling::test_missing_required_organization PASSED [  6%]
backend/tests/test_department_crud.py::TestDepartmentErrorHandling::test_invalid_parent_subdepartment PASSED [  6%]
backend/tests/test_department_crud.py::TestDepartmentErrorHandling::test_department_unicode_name PASSED [  6%]
backend/tests/test_department_crud.py::TestDepartmentErrorHandling::test_circular_subdepartment_reference PASSED [  7%]
backend/tests/test_job_levels_grades.py::TestJobLevelCreation::test_create_job_level_basic PASSED [  7%]
backend/tests/test_job_levels_grades.py::TestJobLevelCreation::test_create_job_level_hierarchy PASSED [  7%]
backend/tests/test_job_levels_grades.py::TestJobLevelCreation::test_retrieve_job_level_by_number PASSED [  8%]
backend/tests/test_job_levels_grades.py::TestJobLevelCreation::test_job_level_numeric_order PASSED [  8%]
backend/tests/test_job_levels_grades.py::TestGradeCreation::test_create_grade_basic PASSED [  9%]
backend/tests/test_job_levels_grades.py::TestGradeCreation::test_create_multiple_grades PASSED [  9%]
backend/tests/test_job_levels_grades.py::TestGradeCreation::test_retrieve_grade_by_level PASSED [  9%]
backend/tests/test_job_levels_grades.py::TestGradeCreation::test_grade_organization_isolation PASSED [ 10%]
backend/tests/test_job_levels_grades.py::TestDesignationCreation::test_create_designation_basic PASSED [ 10%]
backend/tests/test_job_levels_grades.py::TestDesignationCreation::test_create_designation_with_levels PASSED [ 10%]
backend/tests/test_job_levels_grades.py::TestDesignationCreation::test_retrieve_designation_by_department PASSED [ 11%]
backend/tests/test_job_levels_grades.py::TestDesignationCreation::test_designation_grade_relationship PASSED [ 11%]
backend/tests/test_job_levels_grades.py::TestJobDesignationRelationships::test_designation_requires_grade PASSED [ 11%]
backend/tests/test_job_levels_grades.py::TestJobDesignationRelationships::test_designation_requires_department PASSED [ 12%]
backend/tests/test_job_levels_grades.py::TestJobDesignationRelationships::test_employee_with_designation PASSED [ 12%]
backend/tests/test_job_levels_grades.py::TestJobDesignationRelationships::test_job_level_grade_mapping PASSED [ 12%]
backend/tests/test_job_levels_grades.py::TestJobDesignationErrorHandling::test_duplicate_designation_code PASSED [ 13%]
backend/tests/test_job_levels_grades.py::TestJobDesignationErrorHandling::test_negative_grade_level PASSED [ 13%]
backend/tests/test_job_levels_grades.py::TestJobDesignationErrorHandling::test_zero_job_level_number PASSED [ 14%]
backend/tests/test_job_levels_grades.py::TestJobDesignationErrorHandling::test_very_long_designation_name PASSED [ 14%]
backend/tests/test_job_levels_grades.py::TestJobDesignationErrorHandling::test_special_characters_in_code PASSED [ 14%]
backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_create_access_token PASSED [ 15%]
backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_create_refresh_token PASSED [ 15%]
backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_access_token_contains_user_data PASSED [ 15%]
backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_token_has_expiration PASSED [ 16%]
backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_token_type_validation PASSED [ 16%]
backend/tests/test_security_phase2.py::TestTokenRefresh::test_refresh_access_token PASSED [ 16%]
backend/tests/test_security_phase2.py::TestTokenRefresh::test_new_access_token_valid PASSED [ 17%]
backend/tests/test_security_phase2.py::TestTokenRefresh::test_invalid_refresh_token_rejected PASSED [ 17%]
backend/tests/test_security_phase2.py::TestRoleDefinitions::test_all_roles_defined PASSED [ 18%]
backend/tests/test_security_phase2.py::TestRoleDefinitions::test_all_permissions_defined PASSED [ 18%]
backend/tests/test_security_phase2.py::TestRBACPermissions::test_admin_has_all_permissions PASSED [ 18%]
backend/tests/test_security_phase2.py::TestRBACPermissions::test_hr_manager_has_correct_permissions PASSED [ 19%]
backend/tests/test_security_phase2.py::TestRBACPermissions::test_employee_has_limited_permissions PASSED [ 19%]
backend/tests/test_security_phase2.py::TestRBACPermissions::test_multiple_roles_union_permissions PASSED [ 19%]
backend/tests/test_security_phase2.py::TestRBACPermissions::test_invalid_role_ignored PASSED [ 20%]
backend/tests/test_security_phase2.py::TestRBACPermissions::test_empty_roles_no_permissions PASSED [ 20%]
backend/tests/test_security_phase2.py::TestRBACManager::test_get_role_permissions PASSED [ 20%]
backend/tests/test_security_phase2.py::TestRBACManager::test_has_permission_method PASSED [ 21%]
backend/tests/test_security_phase2.py::TestRBACManager::test_get_user_roles PASSED [ 21%]
backend/tests/test_security_phase2.py::TestAuditLogging::test_log_employee_create PASSED [ 22%]
backend/tests/test_security_phase2.py::TestAuditLogging::test_log_employee_update PASSED [ 22%]
backend/tests/test_security_phase2.py::TestAuditLogging::test_log_employee_delete PASSED [ 22%]
backend/tests/test_security_phase2.py::TestAuditLogging::test_log_role_change PASSED [ 23%]
backend/tests/test_security_phase2.py::TestAuditLogging::test_audit_entry_has_timestamp PASSED [ 23%]
backend/tests/test_security_phase2.py::TestEncryption::test_encrypt_string PASSED [ 23%]
backend/tests/test_security_phase2.py::TestEncryption::test_decrypt_string PASSED [ 24%]
backend/tests/test_security_phase2.py::TestEncryption::test_encrypt_none_returns_none PASSED [ 24%]
backend/tests/test_security_phase2.py::TestEncryption::test_decrypt_none_returns_none PASSED [ 24%]
backend/tests/test_security_phase2.py::TestEncryption::test_encrypt_different_values_different_results PASSED [ 25%]
backend/tests/test_security_phase2.py::TestEncryption::test_same_value_encrypts_differently_each_time PASSED [ 25%]
backend/tests/test_security_phase2.py::TestEncryption::test_encrypt_integer PASSED [ 25%]
backend/tests/test_security_phase2.py::TestEncryption::test_function_encrypt_decrypt PASSED [ 26%]
backend/tests/test_security_phase2.py::TestEncryption::test_generate_key PASSED [ 26%]
backend/tests/test_security_phase2.py::TestEncryption::test_different_keys_different_encryption PASSED [ 27%]
backend/tests/test_security_phase2.py::TestSecurityIntegration::test_authenticated_user_with_rbac PASSED [ 27%]
backend/tests/test_security_phase2.py::TestSecurityIntegration::test_audit_logs_encrypted_data PASSED [ 27%]
backend/tests/test_security_phase2.py::TestSecurityIntegration::test_permission_denied_flow PASSED [ 28%]
backend/tests/test_performance_phase2.py::TestInMemoryCache::test_set_and_get_value PASSED [ 28%]
backend/tests/test_performance_phase2.py::TestInMemoryCache::test_get_nonexistent_key PASSED [ 28%]
backend/tests/test_performance_phase2.py::TestInMemoryCache::test_delete_key PASSED [ 29%]
backend/tests/test_performance_phase2.py::TestInMemoryCache::test_delete_nonexistent_key PASSED [ 29%]
backend/tests/test_performance_phase2.py::TestInMemoryCache::test_exists_key PASSED [ 29%]
backend/tests/test_performance_phase2.py::TestInMemoryCache::test_cache_expiration PASSED [ 30%]
backend/tests/test_performance_phase2.py::TestInMemoryCache::test_clear_cache PASSED [ 30%]
backend/tests/test_performance_phase2.py::TestInMemoryCache::test_cache_statistics PASSED [ 31%]
backend/tests/test_performance_phase2.py::TestInMemoryCache::test_cache_different_types PASSED [ 31%]
backend/tests/test_performance_phase2.py::TestCacheManager::test_cache_manager_initialization PASSED [ 31%]
backend/tests/test_performance_phase2.py::TestCacheManager::test_cache_manager_get_set PASSED [ 32%]
backend/tests/test_performance_phase2.py::TestCacheManager::test_cache_manager_delete PASSED [ 32%]
backend/tests/test_performance_phase2.py::TestCacheManager::test_cache_manager_exists PASSED [ 32%]
backend/tests/test_performance_phase2.py::TestCacheManager::test_cache_manager_clear PASSED [ 33%]
backend/tests/test_performance_phase2.py::TestCacheManager::test_cache_key_generation PASSED [ 33%]
backend/tests/test_performance_phase2.py::TestCacheManager::test_cache_stats PASSED [ 33%]
backend/tests/test_performance_phase2.py::TestCacheConvenienceFunctions::test_cache_get_function PASSED [ 34%]
backend/tests/test_performance_phase2.py::TestCacheConvenienceFunctions::test_cache_set_function PASSED [ 34%]
backend/tests/test_performance_phase2.py::TestQueryMetrics::test_add_query_basic PASSED [ 35%]
backend/tests/test_performance_phase2.py::TestQueryMetrics::test_slow_query_detection PASSED [ 35%]
backend/tests/test_performance_phase2.py::TestQueryMetrics::test_slow_query_limit PASSED [ 35%]
backend/tests/test_performance_phase2.py::TestQueryMetrics::test_metrics_statistics PASSED [ 36%]
backend/tests/test_performance_phase2.py::TestQueryOptimizer::test_optimizer_initialization PASSED [ 36%]
backend/tests/test_performance_phase2.py::TestQueryOptimizer::test_connection_pool_configuration PASSED [ 36%]
backend/tests/test_performance_phase2.py::TestQueryOptimizer::test_optimize_joins PASSED [ 37%]
backend/tests/test_performance_phase2.py::TestCachedQueryDecorator::test_cached_query_caches_result PASSED [ 37%]
backend/tests/test_performance_phase2.py::TestCachedQueryDecorator::test_cached_query_custom_key_builder PASSED [ 37%]
backend/tests/test_performance_phase2.py::TestBatchQuery::test_batch_query_splits_into_batches PASSED [ 38%]
backend/tests/test_performance_phase2.py::TestTransactionScope::test_transaction_commit PASSED [ 38%]
backend/tests/test_performance_phase2.py::TestTransactionScope::test_transaction_rollback_on_error PASSED [ 38%]
backend/tests/test_performance_phase2.py::TestTransactionScope::test_transaction_always_closes_session PASSED [ 39%]
backend/tests/test_performance_phase2.py::TestIndexRecommendations::test_recommend_indexes_for_common_patterns PASSED [ 39%]
backend/tests/test_performance_phase2.py::TestIndexRecommendations::test_generate_create_index_sql PASSED [ 40%]
backend/tests/test_performance_phase2.py::TestIndexRecommendations::test_composite_index_recommendation PASSED [ 40%]
backend/tests/test_performance_phase2.py::TestPerformanceIntegration::test_cache_hit_ratio_tracking PASSED [ 40%]
backend/tests/test_performance_phase2.py::TestPerformanceIntegration::test_query_performance_monitoring PASSED [ 41%]
backend/tests/test_performance_phase2.py::TestPerformanceIntegration::test_cache_and_query_optimization_together PASSED [ 41%]
backend/tests/test_performance_phase2.py::TestPerformanceBenchmarks::test_cache_get_performance PASSED [ 41%]
backend/tests/test_performance_phase2.py::TestPerformanceBenchmarks::test_cache_set_performance PASSED [ 42%]
backend/tests/test_performance_phase2.py::TestPerformanceBenchmarks::test_large_cache_hit_ratio PASSED [ 42%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_metrics_initialization PASSED [ 42%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_system_metrics_initialized PASSED [ 43%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_api_metrics_initialized PASSED [ 43%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_database_metrics_initialized PASSED [ 44%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_cache_metrics_initialized PASSED [ 44%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_business_metrics_initialized PASSED [ 44%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_record_api_request PASSED [ 45%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_record_api_request_with_error PASSED [ 45%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_record_database_query PASSED [ 45%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_record_slow_query PASSED [ 46%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_record_cache_operation_hit PASSED [ 46%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_record_cache_operation_miss PASSED [ 46%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_update_cache_hit_ratio PASSED [ 47%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_record_business_change PASSED [ 47%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_record_error PASSED [ 48%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_get_metrics_export PASSED [ 48%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_get_content_type PASSED [ 48%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_global_metrics_instance PASSED [ 49%]
backend/tests/test_monitoring_phase2.py::TestPrometheusMetrics::test_initialize_metrics PASSED [ 49%]
backend/tests/test_monitoring_phase2.py::TestMetricsMiddleware::test_middleware_records_request PASSED [ 49%]
backend/tests/test_monitoring_phase2.py::TestMetricsMiddleware::test_middleware_records_error PASSED [ 50%]
backend/tests/test_monitoring_phase2.py::TestMetricsMiddleware::test_database_metrics_recorder PASSED [ 50%]
backend/tests/test_monitoring_phase2.py::TestMetricsMiddleware::test_cache_metrics_recorder PASSED [ 50%]
backend/tests/test_monitoring_phase2.py::TestMetricsMiddleware::test_business_metrics_recorder PASSED [ 51%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_alert_rules_structure PASSED [ 51%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_alert_groups_defined PASSED [ 51%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_system_alerts_defined PASSED [ 52%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_api_alerts_defined PASSED [ 52%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_database_alerts_defined PASSED [ 53%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_cache_alerts_defined PASSED [ 53%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_alert_rule_structure PASSED [ 53%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_alert_labels_present PASSED [ 54%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_get_alert_rules_yaml PASSED [ 54%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_validate_alert_rules PASSED [ 54%]
backend/tests/test_monitoring_phase2.py::TestAlertRules::test_alert_expressions_syntax PASSED [ 55%]
backend/tests/test_monitoring_phase2.py::TestGrafanaDashboards::test_dashboard_json_structure PASSED [ 55%]
backend/tests/test_monitoring_phase2.py::TestGrafanaDashboards::test_dashboard_panels_exist PASSED [ 55%]
backend/tests/test_monitoring_phase2.py::TestGrafanaDashboards::test_dashboard_has_prometheus_datasource PASSED [ 56%]
backend/tests/test_monitoring_phase2.py::TestGrafanaDashboards::test_dashboard_refresh_interval PASSED [ 56%]
backend/tests/test_monitoring_phase2.py::TestGrafanaDashboards::test_dashboard_time_range PASSED [ 57%]
backend/tests/test_monitoring_phase2.py::TestMetricsIntegration::test_metrics_end_to_end PASSED [ 57%]
backend/tests/test_monitoring_phase2.py::TestMetricsIntegration::test_multiple_operations_tracked PASSED [ 57%]
backend/tests/test_monitoring_phase2.py::TestMetricsIntegration::test_error_tracking PASSED [ 58%]
backend/tests/test_monitoring_phase2.py::TestMetricsIntegration::test_metric_labels_recorded PASSED [ 58%]
backend/tests/test_monitoring_phase2.py::TestMetricsPerformance::test_metrics_recording_speed PASSED [ 58%]
backend/tests/test_monitoring_phase2.py::TestMetricsPerformance::test_concurrent_metrics_recording PASSED [ 59%]
backend/tests/test_monitoring_phase2.py::TestMetricsNamespaces::test_namespace_enum_values PASSED [ 59%]
backend/tests/test_monitoring_phase2.py::TestMetricsNamespaces::test_metric_names_use_namespace PASSED [ 59%]
backend/tests/test_protection_phase2.py::TestRateLimitConfig::test_config_initialization PASSED [ 60%]
backend/tests/test_protection_phase2.py::TestRateLimitConfig::test_config_with_custom_strategy PASSED [ 60%]
backend/tests/test_protection_phase2.py::TestRateLimitConfig::test_config_hour_limit_calculation PASSED [ 61%]
backend/tests/test_protection_phase2.py::TestSlidingWindowLimiter::test_sliding_window_allow_request PASSED [ 61%]
backend/tests/test_protection_phase2.py::TestSlidingWindowLimiter::test_sliding_window_exceed_limit PASSED [ 61%]
backend/tests/test_protection_phase2.py::TestSlidingWindowLimiter::test_sliding_window_different_clients PASSED [ 62%]
backend/tests/test_protection_phase2.py::TestTokenBucketLimiter::test_token_bucket_initialization PASSED [ 62%]
backend/tests/test_protection_phase2.py::TestTokenBucketLimiter::test_token_bucket_allow_request PASSED [ 62%]
backend/tests/test_protection_phase2.py::TestTokenBucketLimiter::test_token_bucket_burst_allowed PASSED [ 63%]
backend/tests/test_protection_phase2.py::TestRateLimiter::test_rate_limiter_add_endpoint PASSED [ 63%]
backend/tests/test_protection_phase2.py::TestRateLimiter::test_rate_limiter_check_endpoint PASSED [ 63%]
backend/tests/test_protection_phase2.py::TestRateLimiter::test_rate_limiter_unconfigured_endpoint PASSED [ 64%]
backend/tests/test_protection_phase2.py::TestRateLimiter::test_rate_limiter_reset_client PASSED [ 64%]
backend/tests/test_protection_phase2.py::TestRequestValidationConfig::test_default_config PASSED [ 64%]
backend/tests/test_protection_phase2.py::TestRequestValidationConfig::test_custom_config PASSED [ 65%]
backend/tests/test_protection_phase2.py::TestPayloadValidator::test_validate_required_fields_success PASSED [ 65%]
backend/tests/test_protection_phase2.py::TestPayloadValidator::test_validate_required_fields_missing PASSED [ 66%]
backend/tests/test_protection_phase2.py::TestPayloadValidator::test_validate_field_types_success PASSED [ 66%]
backend/tests/test_protection_phase2.py::TestPayloadValidator::test_validate_field_types_failure PASSED [ 66%]
backend/tests/test_protection_phase2.py::TestPayloadValidator::test_validate_field_values_success PASSED [ 67%]
backend/tests/test_protection_phase2.py::TestPayloadValidator::test_validate_field_values_failure PASSED [ 67%]
backend/tests/test_protection_phase2.py::TestInputSanitizer::test_sanitize_string_removes_nulls PASSED [ 67%]
backend/tests/test_protection_phase2.py::TestInputSanitizer::test_sanitize_string_trims_whitespace PASSED [ 68%]
backend/tests/test_protection_phase2.py::TestInputSanitizer::test_sanitize_string_max_length PASSED [ 68%]
backend/tests/test_protection_phase2.py::TestInputSanitizer::test_sanitize_dict PASSED [ 68%]
backend/tests/test_protection_phase2.py::TestInputSanitizer::test_detect_sql_injection PASSED [ 69%]
backend/tests/test_protection_phase2.py::TestInputSanitizer::test_detect_script_injection PASSED [ 69%]
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_config_initialization PASSED [ 70%]
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ip_stats_creation PASSED [ 70%]
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_check_ip_safe PASSED [ 70%]
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_record_request PASSED [ 71%]
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_record_error PASSED [ 71%]
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_block_ip PASSED [ 71%]
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_permanent_blacklist PASSED [ 72%]
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_whitelist_ip PASSED [ 72%]
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_threat_summary PASSED [ 72%]
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_error_rate_escalation PASSED [ 73%]
backend/tests/test_protection_phase2.py::TestRateLimiterIntegration::test_multiple_endpoints PASSED [ 73%]
backend/tests/test_protection_phase2.py::TestRateLimiterIntegration::test_rate_limiter_concurrent_access PASSED [ 74%]
backend/tests/test_protection_phase2.py::TestDDoSIntegration::test_ddos_escalation_chain PASSED [ 74%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_scanner_initialization PASSED [ 74%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_scanner_reset PASSED [ 75%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_hardcoded_secrets_detection PASSED [ 75%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_sql_injection_detection PASSED [ 75%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_command_injection_detection PASSED [ 76%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_insecure_deserialization_detection PASSED [ 76%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_weak_cryptography_detection PASSED [ 76%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_hardcoded_credentials_detection PASSED [ 77%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_xxe_vulnerability_detection PASSED [ 77%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_ssrf_vulnerability_detection PASSED [ 77%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_insecure_logging_detection PASSED [ 78%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_vulnerability_to_dict PASSED [ 78%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_get_summary PASSED [ 79%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_scan_python_code PASSED [ 79%]
backend/tests/test_security_scanning_phase2.py::TestSecurityScanner::test_singleton_instance PASSED [ 79%]
backend/tests/test_security_scanning_phase2.py::TestBanditAnalyzer::test_analyzer_initialization PASSED [ 80%]
backend/tests/test_security_scanning_phase2.py::TestBanditAnalyzer::test_bandit_issue_creation PASSED [ 80%]
backend/tests/test_security_scanning_phase2.py::TestBanditAnalyzer::test_bandit_issue_to_dict PASSED [ 80%]
backend/tests/test_security_scanning_phase2.py::TestBanditAnalyzer::test_bandit_summary_generation PASSED [ 81%]
backend/tests/test_security_scanning_phase2.py::TestBanditAnalyzer::test_singleton_instance PASSED [ 81%]
backend/tests/test_security_scanning_phase2.py::TestSemgrepAnalyzer::test_analyzer_initialization PASSED [ 81%]
backend/tests/test_security_scanning_phase2.py::TestSemgrepAnalyzer::test_semgrep_match_creation PASSED [ 82%]
backend/tests/test_security_scanning_phase2.py::TestSemgrepAnalyzer::test_semgrep_match_to_dict PASSED [ 82%]
backend/tests/test_security_scanning_phase2.py::TestSemgrepAnalyzer::test_semgrep_summary_generation PASSED [ 83%]
backend/tests/test_security_scanning_phase2.py::TestSemgrepAnalyzer::test_singleton_instance PASSED [ 83%]
backend/tests/test_security_scanning_phase2.py::TestSemgrepAnalyzer::test_different_instances_for_different_paths PASSED [ 83%]
backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_report_initialization PASSED [ 84%]
backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_metrics_creation PASSED [ 84%]
backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_metrics_as_dict PASSED [ 84%]
backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_summary_generation PASSED [ 85%]
backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_singleton_instance PASSED [ 85%]
backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_json_export_format PASSED [ 85%]
backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_markdown_export_format PASSED [ 86%]
backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_html_export_format PASSED [ 86%]
backend/tests/test_security_scanning_phase2.py::TestIntegration::test_scanner_with_vulnerable_code PASSED [ 87%]
backend/tests/test_security_scanning_phase2.py::TestIntegration::test_multiple_vulnerability_types PASSED [ 87%]
backend/tests/test_security_scanning_phase2.py::TestIntegration::test_severity_levels PASSED [ 87%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_create_employee_basic FAILED [ 88%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_create_employee_with_optional_fields FAILED [ 88%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_create_multiple_employees_same_org PASSED [ 88%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_employee_default_status FAILED [ 89%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_create_employee_unicode_name FAILED [ 89%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_create_employee_email_case_sensitivity FAILED [ 89%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeRetrieval::test_retrieve_employee_by_id FAILED [ 90%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeRetrieval::test_retrieve_employee_not_found PASSED [ 90%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeRetrieval::test_retrieve_employees_by_department PASSED [ 90%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeRetrieval::test_retrieve_employees_by_organization PASSED [ 91%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeRetrieval::test_retrieve_employees_paginated PASSED [ 91%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeRetrieval::test_retrieve_employee_with_relationships FAILED [ 92%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeUpdate::test_update_employee_name FAILED [ 92%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeUpdate::test_update_employee_email FAILED [ 92%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeUpdate::test_update_employee_department FAILED [ 93%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeUpdate::test_update_employee_multiple_fields FAILED [ 93%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeUpdate::test_update_preserves_other_fields FAILED [ 93%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeDelete::test_delete_employee FAILED [ 94%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeDelete::test_delete_employee_cascade_check FAILED [ 94%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeDelete::test_delete_nonexistent_employee PASSED [ 94%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_duplicate_employee_id_error FAILED [ 95%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_missing_required_organization_id FAILED [ 95%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_invalid_department_reference PASSED [ 96%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_invalid_designation_reference PASSED [ 96%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_invalid_email_format FAILED [ 96%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_future_date_of_birth FAILED [ 97%]
backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_joining_date_before_birth_date FAILED [ 97%]
backend/tests/test_employee_crud_expanded.py::TestTransactionBehavior::test_rollback_on_error FAILED [ 97%]
backend/tests/test_employee_crud_expanded.py::TestTransactionBehavior::test_partial_commit_isolation PASSED [ 98%]
backend/tests/test_employee_crud_expanded.py::TestTransactionBehavior::test_nested_updates_in_transaction FAILED [ 98%]
backend/tests/test_employee_crud_expanded.py::TestAggregateOperations::test_count_employees_by_department PASSED [ 98%]
backend/tests/test_employee_crud_expanded.py::TestAggregateOperations::test_count_employees_by_organization PASSED [ 99%]
backend/tests/test_employee_crud_expanded.py::TestAggregateOperations::test_bulk_status_update FAILED [ 99%]
backend/tests/test_employee_crud_expanded.py::TestAggregateOperations::test_distinct_departments_in_org PASSED [100%]

================================== FAILURES ===================================
_______________ TestEmployeeCreation.test_create_employee_basic _______________

self = <test_employee_crud_expanded.TestEmployeeCreation object at 0x0000025BD55E47D0>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD5FF33B0>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_create_employee_basic(self, db, test_employee_data):
        """Test basic employee creation with required fields"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:140: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD618B3B0>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
_______ TestEmployeeCreation.test_create_employee_with_optional_fields ________

self = <test_employee_crud_expanded.TestEmployeeCreation object at 0x0000025BD55E6CC0>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD6010860>
test_employee_data = {'address': '123 Main St', 'alternate_phone': '555-0002', 'city': 'New York', 'country': 'USA', ...}

    def test_create_employee_with_optional_fields(self, db, test_employee_data):
        """Test employee creation with optional fields"""
        test_employee_data.update({
            "alternate_phone": "555-0002",
            "address": "123 Main St",
            "city": "New York",
            "state": "NY",
            "zip_code": "10001",
            "country": "USA"
        })
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:160: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD618B920>
kwargs = {'address': '123 Main St', 'alternate_phone': '555-0002', 'city': 'New York', 'country': 'USA', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
______________ TestEmployeeCreation.test_employee_default_status ______________

self = <test_employee_crud_expanded.TestEmployeeCreation object at 0x0000025BD55E74A0>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD5FF1D90>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_employee_default_status(self, db, test_employee_data):
        """Test employee default status is ACTIVE"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:192: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD5A0BE00>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
___________ TestEmployeeCreation.test_create_employee_unicode_name ____________

self = <test_employee_crud_expanded.TestEmployeeCreation object at 0x0000025BD55E7890>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD60C5940>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_create_employee_unicode_name(self, db, test_employee_data):
        """Test employee creation with unicode characters in name"""
        test_employee_data["name"] = "Fran├ºois M├╝ller"
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:203: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD59AF440>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
______ TestEmployeeCreation.test_create_employee_email_case_sensitivity _______

self = <test_employee_crud_expanded.TestEmployeeCreation object at 0x0000025BD55E7C80>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD5A41850>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_create_employee_email_case_sensitivity(self, db, test_employee_data):
        """Test email is handled correctly"""
        test_employee_data["email"] = "JOHN.DOE@TEST.COM"
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:214: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD6233320>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
_____________ TestEmployeeRetrieval.test_retrieve_employee_by_id ______________

self = <test_employee_crud_expanded.TestEmployeeRetrieval object at 0x0000025BD55F8110>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD618B5C0>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_retrieve_employee_by_id(self, db, test_employee_data):
        """Test retrieving employee by ID"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:231: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD6233C50>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
_______ TestEmployeeRetrieval.test_retrieve_employee_with_relationships _______

self = <test_employee_crud_expanded.TestEmployeeRetrieval object at 0x0000025BD55E7650>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD59E6DB0>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
test_dept = <backend.domains.core.models.DBDepartment object at 0x0000025BD6233620>
test_designation = <backend.domains.hcm.models.DBDesignation object at 0x0000025BD59E56A0>

    def test_retrieve_employee_with_relationships(self, db, test_employee_data, test_dept, test_designation):
        """Test retrieving employee with related objects"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:320: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD59E52E0>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
________________ TestEmployeeUpdate.test_update_employee_name _________________

self = <test_employee_crud_expanded.TestEmployeeUpdate object at 0x0000025BD55E6E10>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD59E6180>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_update_employee_name(self, db, test_employee_data):
        """Test updating employee name"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:343: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD59ACB90>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
________________ TestEmployeeUpdate.test_update_employee_email ________________

self = <test_employee_crud_expanded.TestEmployeeUpdate object at 0x0000025BD55E6630>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD59AE3F0>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_update_employee_email(self, db, test_employee_data):
        """Test updating employee email"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:355: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD6233320>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
_____________ TestEmployeeUpdate.test_update_employee_department ______________

self = <test_employee_crud_expanded.TestEmployeeUpdate object at 0x0000025BD55F8BF0>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD59ADE50>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
test_org = <backend.domains.core.models.DBOrganization object at 0x0000025BD61C5A00>

    def test_update_employee_department(self, db, test_employee_data, test_org):
        """Test moving employee to different department"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:369: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD61C56A0>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
___________ TestEmployeeUpdate.test_update_employee_multiple_fields ___________

self = <test_employee_crud_expanded.TestEmployeeUpdate object at 0x0000025BD55F8230>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD59AF410>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_update_employee_multiple_fields(self, db, test_employee_data):
        """Test updating multiple fields at once"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:397: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD6233620>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
____________ TestEmployeeUpdate.test_update_preserves_other_fields ____________

self = <test_employee_crud_expanded.TestEmployeeUpdate object at 0x0000025BD55F9400>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD59E7EF0>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_update_preserves_other_fields(self, db, test_employee_data):
        """Test that updating one field doesn't affect others"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:419: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD59E69F0>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
___________________ TestEmployeeDelete.test_delete_employee ___________________

self = <test_employee_crud_expanded.TestEmployeeDelete object at 0x0000025BD55F9880>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD61C65D0>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_delete_employee(self, db, test_employee_data):
        """Test deleting an employee"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:444: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD627F710>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
____________ TestEmployeeDelete.test_delete_employee_cascade_check ____________

self = <test_employee_crud_expanded.TestEmployeeDelete object at 0x0000025BD55F9C70>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD61C7AA0>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_delete_employee_cascade_check(self, db, test_employee_data):
        """Test cascading deletion if applicable"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:459: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD623DFD0>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
_________ TestEmployeeErrorHandling.test_duplicate_employee_id_error __________

self = <test_employee_crud_expanded.TestEmployeeErrorHandling object at 0x0000025BD55FA3C0>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD627D100>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_duplicate_employee_id_error(self, db, test_employee_data):
        """Test that duplicate employee ID raises error"""
>       emp1 = DBEmployee(**test_employee_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:491: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD55F9D30>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
_______ TestEmployeeErrorHandling.test_missing_required_organization_id _______

self = <test_employee_crud_expanded.TestEmployeeErrorHandling object at 0x0000025BD55FA7B0>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD627D7C0>
test_dept = <backend.domains.core.models.DBDepartment object at 0x0000025BD627E930>
test_designation = <backend.domains.hcm.models.DBDesignation object at 0x0000025BD623E390>

    def test_missing_required_organization_id(self, db, test_dept, test_designation):
        """Test creating employee without organization_id"""
        emp_data = {
            "id": "EMP_NO_ORG",
            "name": "No Org",
            "email": "no_org@test.com",
            "department_id": test_dept.id,
            "designation_id": test_designation.id,
            "organization_id": None  # Missing required field
        }
    
        emp = DBEmployee(**emp_data)
        db.add(emp)
    
        # Should raise error on commit due to NOT NULL constraint
>       with pytest.raises(Exception):
             ^^^^^^^^^^^^^^^^^^^^^^^^
E       Failed: DID NOT RAISE <class 'Exception'>

backend\tests\test_employee_crud_expanded.py:517: Failed
_____________ TestEmployeeErrorHandling.test_invalid_email_format _____________

self = <test_employee_crud_expanded.TestEmployeeErrorHandling object at 0x0000025BD55FB200>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD623DD90>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_invalid_email_format(self, db, test_employee_data):
        """Test creating employee with invalid email format"""
        test_employee_data["email"] = "not_an_email"
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:558: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD623DBB0>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
_____________ TestEmployeeErrorHandling.test_future_date_of_birth _____________

self = <test_employee_crud_expanded.TestEmployeeErrorHandling object at 0x0000025BD55FB5F0>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD62C77A0>
test_employee_data = {'date_of_birth': datetime.date(2030, 1, 1), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_future_date_of_birth(self, db, test_employee_data):
        """Test employee with future date of birth"""
        test_employee_data["date_of_birth"] = date(2030, 1, 1)
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:567: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD623D040>
kwargs = {'date_of_birth': datetime.date(2030, 1, 1), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
________ TestEmployeeErrorHandling.test_joining_date_before_birth_date ________

self = <test_employee_crud_expanded.TestEmployeeErrorHandling object at 0x0000025BD55E6F00>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD59ADEB0>
test_employee_data = {'date_of_birth': datetime.date(2000, 1, 1), 'date_of_joining': datetime.date(1990, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_joining_date_before_birth_date(self, db, test_employee_data):
        """Test employee joining before birth date"""
        test_employee_data["date_of_birth"] = date(2000, 1, 1)
        test_employee_data["date_of_joining"] = date(1990, 1, 1)
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:576: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD62C6D50>
kwargs = {'date_of_birth': datetime.date(2000, 1, 1), 'date_of_joining': datetime.date(1990, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
_______________ TestTransactionBehavior.test_rollback_on_error ________________

self = <test_employee_crud_expanded.TestTransactionBehavior object at 0x0000025BD55FB530>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD627C8F0>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}

    def test_rollback_on_error(self, db, test_employee_data):
        """Test rollback when error occurs"""
>       emp1 = DBEmployee(**test_employee_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:591: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD623F770>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
_________ TestTransactionBehavior.test_nested_updates_in_transaction __________

self = <test_employee_crud_expanded.TestTransactionBehavior object at 0x0000025BD55FA210>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD627FC50>
test_employee_data = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
test_org = <backend.domains.core.models.DBOrganization object at 0x0000025BD628E3C0>

    def test_nested_updates_in_transaction(self, db, test_employee_data, test_org):
        """Test multiple updates within single transaction"""
>       emp = DBEmployee(**test_employee_data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

backend\tests\test_employee_crud_expanded.py:636: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD628E4E0>
kwargs = {'date_of_birth': datetime.date(1990, 5, 15), 'date_of_joining': datetime.date(2025, 1, 1), 'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'date_of_joining'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'date_of_joining' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
_______________ TestAggregateOperations.test_bulk_status_update _______________

self = <test_employee_crud_expanded.TestAggregateOperations object at 0x0000025BD55F8A40>
db = <sqlalchemy.orm.session.Session object at 0x0000025BD627C8F0>
test_org = <backend.domains.core.models.DBOrganization object at 0x0000025BD623EAE0>
test_dept = <backend.domains.core.models.DBDepartment object at 0x0000025BD623F800>
test_designation = <backend.domains.hcm.models.DBDesignation object at 0x0000025BD62C58B0>

    def test_bulk_status_update(self, db, test_org, test_dept, test_designation):
        """Test updating status for multiple employees"""
        # Create 3 employees
        emp_ids = []
        for i in range(3):
>           emp = DBEmployee(
                id=f"EMP_BULK_{i}",
                name=f"First {i} Last {i}",
                email=f"bulk{i}@test.com",
                department_id=test_dept.id,
                designation_id=test_designation.id,
                organization_id=test_org.id,
                is_active=True
            )

backend\tests\test_employee_crud_expanded.py:716: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
venv\Lib\site-packages\sqlalchemy\orm\state.py:596: in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\sqlalchemy\util\langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv\Lib\site-packages\sqlalchemy\orm\state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <backend.domains.hcm.models.DBEmployee object at 0x0000025BD62C7770>
kwargs = {'department_id': 'DEPT_TEST', 'designation_id': 'DES_001', 'email': 'bulk0@test.com', 'id': 'EMP_BULK_0', ...}
cls_ = <class 'backend.domains.hcm.models.DBEmployee'>, k = 'is_active'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'is_active' is an invalid keyword argument for DBEmployee

venv\Lib\site-packages\sqlalchemy\orm\decl_base.py:2179: TypeError
============================== warnings summary ===============================
backend\database\__init__.py:62
  D:\Project\PEOPLE_OS\backend\database\__init__.py:62: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

venv\Lib\site-packages\pydantic\_internal\_config.py:271: 82 warnings
  D:\Project\PEOPLE_OS\venv\Lib\site-packages\pydantic\_internal\_config.py:271: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

backend/tests/test_department_crud.py: 20 warnings
backend/tests/test_job_levels_grades.py: 21 warnings
backend/tests/test_employee_crud_expanded.py: 34 warnings
  D:\Project\PEOPLE_OS\backend\tests\conftest.py:51: SAWarning: Can't sort tables for DROP; an unresolvable foreign key dependency exists between tables: core_departments, core_locations, core_organizations, core_sub_departments, core_users, hcm_designations, hcm_employees, hcm_grades, hcm_job_levels, hcm_shifts; and backend does not support ALTER.  To restore at least a partial sort, apply use_alter=True to ForeignKey and ForeignKeyConstraint objects involved in the cycle to mark these as known cycles that will be ignored.
    Base.metadata.drop_all(bind=conn)

backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_create_access_token
backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_access_token_contains_user_data
backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_token_has_expiration
backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_token_type_validation
backend/tests/test_security_phase2.py::TestTokenRefresh::test_refresh_access_token
backend/tests/test_security_phase2.py::TestTokenRefresh::test_new_access_token_valid
backend/tests/test_security_phase2.py::TestSecurityIntegration::test_authenticated_user_with_rbac
backend/tests/test_security_phase2.py::TestSecurityIntegration::test_permission_denied_flow
  D:\Project\PEOPLE_OS\backend\security\oauth2.py:68: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "exp": datetime.utcnow() + expires_delta,

backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_create_refresh_token
backend/tests/test_security_phase2.py::TestTokenRefresh::test_refresh_access_token
backend/tests/test_security_phase2.py::TestTokenRefresh::test_refresh_access_token
backend/tests/test_security_phase2.py::TestTokenRefresh::test_new_access_token_valid
backend/tests/test_security_phase2.py::TestTokenRefresh::test_new_access_token_valid
  D:\Project\PEOPLE_OS\backend\security\oauth2.py:98: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "exp": datetime.utcnow() + expires_delta,

backend/tests/test_security_phase2.py::TestJWTTokenGeneration::test_token_has_expiration
  D:\Project\PEOPLE_OS\backend\tests\test_security_phase2.py:93: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    assert token_data.exp > datetime.utcnow()

backend/tests/test_security_phase2.py::TestAuditLogging::test_log_employee_create
backend/tests/test_security_phase2.py::TestAuditLogging::test_log_employee_update
backend/tests/test_security_phase2.py::TestAuditLogging::test_log_employee_delete
backend/tests/test_security_phase2.py::TestAuditLogging::test_log_role_change
backend/tests/test_security_phase2.py::TestAuditLogging::test_audit_entry_has_timestamp
backend/tests/test_security_phase2.py::TestSecurityIntegration::test_audit_logs_encrypted_data
backend/tests/test_security_phase2.py::TestSecurityIntegration::test_permission_denied_flow
  D:\Project\PEOPLE_OS\backend\security\audit_logger.py:85: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    timestamp = datetime.utcnow()

backend/tests/test_performance_phase2.py: 2023 warnings
  D:\Project\PEOPLE_OS\backend\cache\redis_manager.py:224: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "expires": datetime.utcnow() + timedelta(seconds=ttl),

backend/tests/test_performance_phase2.py: 1814 warnings
  D:\Project\PEOPLE_OS\backend\cache\redis_manager.py:211: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    if entry["expires"] > datetime.utcnow():

backend/tests/test_performance_phase2.py::TestInMemoryCache::test_exists_key
backend/tests/test_performance_phase2.py::TestCacheManager::test_cache_manager_exists
backend/tests/test_performance_phase2.py::TestCachedQueryDecorator::test_cached_query_custom_key_builder
  D:\Project\PEOPLE_OS\backend\cache\redis_manager.py:242: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    if entry["expires"] > datetime.utcnow():

backend/tests/test_performance_phase2.py: 153 warnings
  D:\Project\PEOPLE_OS\backend\database\query_optimizer.py:47: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "timestamp": datetime.utcnow(),

backend/tests/test_monitoring_phase2.py::TestMetricsMiddleware::test_middleware_records_request
backend/tests/test_monitoring_phase2.py::TestMetricsMiddleware::test_middleware_records_error
  D:\Project\PEOPLE_OS\venv\Lib\site-packages\httpx\_client.py:680: DeprecationWarning: The 'app' shortcut is now deprecated. Use the explicit style 'transport=WSGITransport(app=...)' instead.
    warnings.warn(message, DeprecationWarning)

backend/tests/test_protection_phase2.py: 134 warnings
  D:\Project\PEOPLE_OS\backend\protection\rate_limiter.py:65: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

backend/tests/test_protection_phase2.py: 16 warnings
  D:\Project\PEOPLE_OS\backend\protection\rate_limiter.py:139: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

backend/tests/test_protection_phase2.py::TestRateLimiter::test_rate_limiter_unconfigured_endpoint
  D:\Project\PEOPLE_OS\backend\protection\rate_limiter.py:213: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    reset_time=datetime.utcnow() + timedelta(hours=1),

backend/tests/test_protection_phase2.py: 10 warnings
  <string>:7: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).

backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_check_ip_safe
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_record_request
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_record_error
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_block_ip
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_permanent_blacklist
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_whitelist_ip
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_threat_summary
backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_error_rate_escalation
backend/tests/test_protection_phase2.py::TestDDoSIntegration::test_ddos_escalation_chain
  D:\Project\PEOPLE_OS\backend\protection\ddos_protection.py:80: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    self.last_cleanup = datetime.utcnow()

backend/tests/test_protection_phase2.py: 205 warnings
  D:\Project\PEOPLE_OS\backend\protection\ddos_protection.py:118: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    stats.last_request = datetime.utcnow()

backend/tests/test_protection_phase2.py: 205 warnings
  D:\Project\PEOPLE_OS\backend\protection\ddos_protection.py:213: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    if (datetime.utcnow() - self.last_cleanup).total_seconds() < self.config.cleanup_interval:

backend/tests/test_protection_phase2.py: 10 warnings
  D:\Project\PEOPLE_OS\backend\protection\ddos_protection.py:191: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    ban_until = datetime.utcnow() + timedelta(seconds=self.config.temporary_ban_duration)

backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_block_ip
  D:\Project\PEOPLE_OS\backend\protection\ddos_protection.py:92: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    if datetime.utcnow() < ban_time:

backend/tests/test_protection_phase2.py::TestDDoSProtector::test_ddos_block_ip
  D:\Project\PEOPLE_OS\backend\protection\ddos_protection.py:93: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    remaining = int((ban_time - datetime.utcnow()).total_seconds())

backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_metrics_creation
  D:\Project\PEOPLE_OS\backend\tests\test_security_scanning_phase2.py:387: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    timestamp=datetime.utcnow().isoformat()

backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_metrics_as_dict
  D:\Project\PEOPLE_OS\backend\tests\test_security_scanning_phase2.py:395: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    timestamp = datetime.utcnow().isoformat()

backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_summary_generation
  D:\Project\PEOPLE_OS\backend\tests\test_security_scanning_phase2.py:425: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    timestamp=datetime.utcnow().isoformat()

backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_summary_generation
  D:\Project\PEOPLE_OS\backend\tests\test_security_scanning_phase2.py:427: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    report.generated_at = datetime.utcnow().isoformat()

backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_json_export_format
  D:\Project\PEOPLE_OS\backend\tests\test_security_scanning_phase2.py:446: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'generated_at': datetime.utcnow().isoformat(),

backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_json_export_format
  D:\Project\PEOPLE_OS\backend\tests\test_security_scanning_phase2.py:458: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'timestamp': datetime.utcnow().isoformat()

backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_markdown_export_format
  D:\Project\PEOPLE_OS\backend\tests\test_security_scanning_phase2.py:475: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'generated_at': datetime.utcnow().isoformat(),

backend/tests/test_security_scanning_phase2.py::TestSecurityReport::test_html_export_format
  D:\Project\PEOPLE_OS\backend\tests\test_security_scanning_phase2.py:510: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'generated_at': datetime.utcnow().isoformat(),

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_create_employee_basic
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_create_employee_with_optional_fields
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_employee_default_status
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_create_employee_unicode_name
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeCreation::test_create_employee_email_case_sensitivity
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeRetrieval::test_retrieve_employee_by_id
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeRetrieval::test_retrieve_employee_with_relationships
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeUpdate::test_update_employee_name
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeUpdate::test_update_employee_email
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeUpdate::test_update_employee_department
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeUpdate::test_update_employee_multiple_fields
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeUpdate::test_update_preserves_other_fields
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeDelete::test_delete_employee
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeDelete::test_delete_employee_cascade_check
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_duplicate_employee_id_error
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_missing_required_organization_id
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_invalid_email_format
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_future_date_of_birth
FAILED backend/tests/test_employee_crud_expanded.py::TestEmployeeErrorHandling::test_joining_date_before_birth_date
FAILED backend/tests/test_employee_crud_expanded.py::TestTransactionBehavior::test_rollback_on_error
FAILED backend/tests/test_employee_crud_expanded.py::TestTransactionBehavior::test_nested_updates_in_transaction
FAILED backend/tests/test_employee_crud_expanded.py::TestAggregateOperations::test_bulk_status_update
=============== 22 failed, 255 passed, 4774 warnings in 15.30s ================
